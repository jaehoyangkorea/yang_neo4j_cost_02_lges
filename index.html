<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LGì—ë„ˆì§€ì†”ë£¨ì…˜ ë°°í„°ë¦¬ ì›ê°€ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            text-align: center;
        }
        
        h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.2em;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 10px;
        }
        
        .stat-value {
            color: #333;
            font-size: 2em;
            font-weight: bold;
        }
        
        .stat-value.negative {
            color: #e74c3c;
        }
        
        .stat-value.positive {
            color: #27ae60;
        }
        
        .actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .action-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
            transition: all 0.3s;
        }
        
        .action-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .action-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }
        
        .action-title {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 10px;
        }
        
        .action-desc {
            color: #666;
            margin-bottom: 20px;
        }
        
        .btn {
            display: inline-block;
            padding: 12px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .variance-list {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-top: 30px;
        }
        
        .variance-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .variance-item:last-child {
            border-bottom: none;
        }
        
        .severity-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
        }
        
        .severity-high {
            background: #ffe0e0;
            color: #e74c3c;
        }
        
        .severity-medium {
            background: #fff5e0;
            color: #f39c12;
        }
        
        .severity-low {
            background: #e0f5ff;
            color: #3498db;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            color: white;
            font-size: 1.5em;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ”‹ LGì—ë„ˆì§€ì†”ë£¨ì…˜ ë°°í„°ë¦¬ ì›ê°€ ë¶„ì„</h1>
            <p class="subtitle">Neo4j ê¸°ë°˜ ì›ê°€ì°¨ì´ ë¶„ì„ ì‹œìŠ¤í…œ</p>
        </header>
        
        <div id="loading" class="loading">
            ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
        </div>
        
        <div id="dashboard" style="display: none;">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">ğŸ“¦ ì „ì²´ ìƒì‚°ì˜¤ë”</div>
                    <div class="stat-value" id="totalOrders">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">ğŸ” ì›ê°€ì°¨ì´ ê±´ìˆ˜</div>
                    <div class="stat-value" id="totalVariances">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">ğŸ’° ì´ ì›ê°€ì°¨ì´</div>
                    <div class="stat-value negative" id="totalVarianceAmount">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">ğŸ“Š í‰ê·  ì°¨ì´ìœ¨</div>
                    <div class="stat-value" id="avgVariancePercent">-</div>
                </div>
            </div>
            
            <div class="variance-list">
                <h2 style="margin-bottom: 20px;">ì›ê°€ìš”ì†Œë³„ ì°¨ì´ ë¶„ì„</h2>
                <div id="varianceByType"></div>
            </div>
            
            <div class="actions">
                <div class="action-card">
                    <div class="action-icon">ğŸŒ</div>
                    <div class="action-title">ê·¸ë˜í”„ ë„¤íŠ¸ì›Œí¬</div>
                    <p class="action-desc">Neo4j ê·¸ë˜í”„ë¡œ ì›ê°€ íë¦„ ì‹œê°í™”</p>
                    <a href="variance_graph_dashboard_v3.html" class="btn">ê·¸ë˜í”„ ë³´ê¸°</a>
                </div>
                
                <div class="action-card">
                    <div class="action-icon">ğŸ“Š</div>
                    <div class="action-title">ìƒì„¸ ëŒ€ì‹œë³´ë“œ</div>
                    <p class="action-desc">ì°¨íŠ¸ì™€ í†µê³„ë¡œ ì›ê°€ ë¶„ì„</p>
                    <a href="dashboard.html" class="btn">ëŒ€ì‹œë³´ë“œ ì—´ê¸°</a>
                </div>
                
                <div class="action-card">
                    <div class="action-icon">âš–ï¸</div>
                    <div class="action-title">ë¹„êµ ë¶„ì„</div>
                    <p class="action-desc">ìƒì‚°ì˜¤ë” ê°„ ë¹„êµ ë¶„ì„</p>
                    <a href="comparison.html" class="btn">ë¹„êµí•˜ê¸°</a>
                </div>
                
                <div class="action-card">
                    <div class="action-icon">ğŸ”—</div>
                    <div class="action-title">Neo4j Browser</div>
                    <p class="action-desc">ì§ì ‘ ì¿¼ë¦¬ ì‹¤í–‰í•˜ê¸°</p>
                    <a href="https://console.neo4j.io" target="_blank" class="btn">Neo4j ì—´ê¸°</a>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // APIì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        async function loadData() {
            try {
                // ìš”ì•½ ë°ì´í„°
                const summaryRes = await fetch('http://localhost:8000/api/summary');
                const summary = await summaryRes.json();
                
                // ì „ì²´ í†µê³„
                const overviewRes = await fetch('http://localhost:8000/api/overview');
                const overview = await overviewRes.json();
                
                // ë°ì´í„° í‘œì‹œ
                document.getElementById('totalOrders').textContent = overview.production_orders || '-';
                document.getElementById('totalVariances').textContent = overview.variances || '-';
                
                // ì´ ì›ê°€ì°¨ì´ ê³„ì‚°
                let totalVariance = 0;
                summary.forEach(item => {
                    totalVariance += item.total || 0;
                });
                document.getElementById('totalVarianceAmount').textContent = 
                    (totalVariance / 1000000000).toFixed(1) + 'ì–µì›';
                
                // í‰ê·  ì°¨ì´ìœ¨ (ì„ì‹œ)
                document.getElementById('avgVariancePercent').textContent = '16.4%';
                
                // ì›ê°€ìš”ì†Œë³„ ì°¨ì´
                const varianceByTypeDiv = document.getElementById('varianceByType');
                const elementMap = {
                    'MATERIAL': 'ì¬ë£Œë¹„',
                    'LABOR': 'ë…¸ë¬´ë¹„',
                    'OVERHEAD': 'ê²½ë¹„'
                };
                const typeMap = {
                    'PRICE': 'ë‹¨ê°€ì°¨ì´',
                    'QUANTITY': 'ìˆ˜ëŸ‰ì°¨ì´',
                    'VOLUME': 'ì¡°ì—…ë„ì°¨ì´',
                    'RATE': 'ì„ë¥ ì°¨ì´',
                    'EFFICIENCY': 'íš¨ìœ¨ì°¨ì´',
                    'SPENDING': 'ì§€ì¶œì°¨ì´'
                };
                
                summary.forEach(item => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'variance-item';
                    
                    const severity = item.count > 80 ? 'high' : item.count > 50 ? 'medium' : 'low';
                    
                    itemDiv.innerHTML = `
                        <div>
                            <strong>${elementMap[item.element] || item.element}</strong> - 
                            ${typeMap[item.type] || item.type}
                        </div>
                        <div>
                            <span class="severity-badge severity-${severity}">${item.count}ê±´</span>
                            <strong style="margin-left: 15px; color: #e74c3c;">
                                ${(item.total / 1000000).toFixed(0)}ë°±ë§Œì›
                            </strong>
                        </div>
                    `;
                    
                    varianceByTypeDiv.appendChild(itemDiv);
                });
                
                // ë¡œë”© ìˆ¨ê¸°ê³  ëŒ€ì‹œë³´ë“œ í‘œì‹œ
                document.getElementById('loading').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                
            } catch (error) {
                console.error('ë°ì´í„° ë¡œë”© ì‹¤íŒ¨:', error);
                document.getElementById('loading').innerHTML = 
                    '<p style="color: #e74c3c;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.<br>ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.</p>';
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        loadData();
    </script>
</body>
</html>
